{% extends 'admin/layout_admin.html.twig' %}

{% block stylesheets %}
	{{ parent() }}
	<!-- Custom styles for this template -->
	<link href="{{ asset('css/admin-area.css') }}" rel="stylesheet">
{% endblock %}

{% block body %}
	{{ parent() }}
  <div class="container">
		{{ include('admin/messages/success.html.twig') }}
		{{ include('admin/messages/danger.html.twig') }}
    <div class="col-md-12">
      <div class="page-header">
        <h2  align="center"> Lista de Usuarios</h2>
      </div>
			<a href="{{ path('nuevo_usuario') }}" class="btn btn-sm btn-primary">Crear usuario</a>
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr class="table-header">
							<th>ID</th>
              <th>usuario</th>
              <th>Correo electronico</th>
              <th>Empresa</th>
              <th>Tipo</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            {% for user in users %}
							<!-- Si el usuario esta activo -->
							{% if user.isActive == '1' %}
								<tr id="fila" data-id="{{ user.id }}">
									<td>{{ user.id }}</td>
	                <td>{{ user.name }}</td>
	                <td>{{ user.email }}</td>
	                <td>{{ user.empresa }}</td>
	                <td>
	                  {% if user.role == 'ROLE_ADMIN' %}
	                    <span class="badge badge-success">Administrador</span>
	                  {% elseif user.role == 'ROLE_USER' %}
	                    <span class="badge badge-info">Usuario</span>
	                  {% endif %}
	                </td>
	                <td>
	                  <a id="boton-editar" href="#" class="btn btn-sm btn-primary">Cambiar tipo</a>
										<a id="boton-bloquear" href="{{ path('user_block', { id : user.id}) }}" class="btn btn-sm btn-secondary btn-blocked">Bloquear</a>
	                  <a id="boton-eliminar" href="{{ path('user_delete', { id : user.id }) }}" class="btn btn-sm btn-danger btn-delete">Eliminar</a>
	                </td>
	              </tr>

							<!-- si el usuario esta inactivo -->
							{% elseif user.isActive == '0' %}
								<tr id="fila" data-id="{{ user.id }}" class="row-blocked">
									<td>{{ user.id }}</td>
	                <td>{{ user.name }}</td>
	                <td>{{ user.email }}</td>
	                <td>{{ user.empresa }}</td>
	                <td>
	                  {% if user.role == 'ROLE_ADMIN' %}
	                    <span class="badge badge-success">Administrador</span>
	                  {% elseif user.role == 'ROLE_USER' %}
	                    <span class="badge badge-info">Usuario</span>
	                  {% endif %}
	                </td>
	                <td>
	                  <a id="boton-editar" href="#" class="btn btn-sm btn-primary disabled">Cambiar tipo</a>
										<a id="boton-desbloquear" href="{{ path('user_unblock', { id : user.id}) }}" class="btn btn-sm btn-secondary btn-unblocked">Desbloquear</a>
	                  <a id="boton-eliminar" href="{{ path('user_delete', { id : user.id }) }}" class="btn btn-sm btn-danger btn-delete disabled">Eliminar</a>
	                </td>
	              </tr>

							{% endif %}
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

	{{ include('admin/delete-user.html.twig', { form: delete_form_ajax, id: 'form-delete'}) }}
	{{ include('admin/block-user.html.twig',  { form: block_form_ajax, id: 'form-block'}) }}
	{{ include('admin/unblock-user.html.twig', { form: unblock_form_ajax, id: 'form-unblock'}) }}

{% endblock %}

{% block javascripts %}
	{{ parent() }}



	<script src="{{ asset('js/delete-user.js') }}"></script>
	<script src="{{ asset('js/block-user.js') }}"></script>
	<script src="{{ asset('js/unblock-user.js') }}"></script>

{% endblock %}
